# Open CAS Telemetry Framework

Open CAS Telemetry Framework (OCTF) contains building blocks for the development
of a telemetry and monitoring environment. An example could be an IO tracer for
Open-CAS. The major functionality of the OCTF library is:
 - creation of telemetry trace with events
 - management of captured traces
 - parsing traces

Another minor capabilities are:
- providing auto CLI API
- RPC communication interface between OCTF components/services

At the moment the OCTF native Linux library is utilized by
[Standalone Linux IO Tracer](https://github.com/Open-CAS/standalone-linux-io-tracer)

# In this readme:

* [Source Code](#source)
* [Building](#building)
* [Deployment](#deployment)
* [Documentation](#documentation)
* [Unit Tests](#unit_tests)
* [Contributing](#contributing)
* [Related Projects](#related_projects)
* [Notice](#notice)

<a id="source"></a>

## Source Code

Source code is available in the official OCTF GitHub repository:

~~~{.sh}
git clone https://github.com/open-cas/open-cas-telemetry-framework
cd open-cas-telemetry-framework
~~~

<a id="building"></a>

## Building

To build OCTF, the following tools are needed:
* Google Protocol Buffers, version 3.6.1 or higher, please follow this link for
[C++ Installation Instructions](https://github.com/google/protobuf/blob/master/src/README.md)
* Google Tests for unit tests
* CMake 3.1 or above

> **NOTE:**  You can use setup dependencies script to install above tools.
> 
~~~{.sh}
sudo ./setup_dependencies.sh
~~~

Building command is:

~~~{.sh}
make
~~~

Optionally you can specify environment variables to override:
- build type - 'release' is the default, specifying DEBUG=1 enables 'debug' build.
- build directory - with BUILD_DIR=&lt;dir&gt; statement, default is 'build/&lt;release|debug&gt;.
- installation prefix.

~~~{.sh}
[DEBUG=1] [BUILD_DIR=<BUILD_PATH>] [PREFIX=<INSTALLATION_PATH>] make
~~~

<a id="deployment"></a>

## Deployment

##### Installation

For OCTF installation call:

~~~{.sh}
[DEBUG=1] [PREFIX=<INSTALLATION_PATH>] make install
~~~

This will install OCTF components: library, headers, configuration file,
documentation, etc. If prefix is a relative path then final installation path
will be BUILD_PATH/PREFIX. If prefix is an absolute path then final installation
path will be PREFIX.

For release build default value of PREFIX is '/'. For debug build (DEBUG=1)
default value of PREFIX is './rootfs'.

##### Configuration

If you would like to change locations where OCTF stores its data, please
edit the configuration file. For PREFIX=/ the configuration file is located at
__/etc/octf/octf.conf__.

Configurable variables:
* settings - additional program settings location
* unixsocket - location of creating unix sockets for runtime communication
* trace - trace files location

Default content of file /etc/octf/octf.conf:

~~~{.sh}
{
  "paths": {
  "settings": "/var/lib/octf/settings",
  "unixsocket": "/run/octf/sockets",
  "trace": "/var/lib/octf/trace",
  }
}
~~~

<a id="documentation"></a>

## Documentation

Doxygen API documentation is available and it can be generated by executing:

~~~{.sh}
make doc
~~~

Output doxygen HTML documentation is placed in

~~~{.sh}
build/release/doc/html/index.html
~~~

More documentation, tutorial, and examples will be available soon.

<a id="unit_tests"></a>

## Unit Tests

The unit tests are run by executing:

~~~{.sh}
make test
~~~

<a id="contributing"></a>

## Contributing

Feel like making OCTF better? Don't hesitate to submit a pull request!
You can find more information about our contribution process
[here](https://github.com/Open-CAS/open-cas-telemetry-framework/blob/master/CONTRIBUTING.md).
In case of any questions feel free to contact [maintainers](mailto:mariusz.barczak@intel.com;tomasz.rybicki@intel.com).

<a id="related_projects"></a>

## Related Projects
Please explore related projects:
* [Standalone Linux IO Tracer](https://github.com/Open-CAS/standalone-linux-io-tracer) -
the Linux tool for advanced IO tracing that utilizes OCTF
* [Open CAS Framework](https://github.com/Open-CAS/ocf) - high performance block
storage caching meta-library
* [Open CAS Linux](https://github.com/Open-CAS/open-cas-linux) - Linux block storage cache

<a id="notice"></a>

## Notice

OCTF uses:
- Google Protocol Buffers
- SeCoe Safe String Library

[NOTICE](https://github.com/Open-CAS/open-cas-telemetry-framework/blob/master/doc/NOTICE)
contains more information

